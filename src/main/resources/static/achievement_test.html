<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8" />
  <title>Achievement API Tester</title>
  <style>
    body { font-family: 'Pretendard', sans-serif; margin: 40px; background: #f7f8fa; }
    h2 { color: #333; }
    input, button { padding: 8px; margin: 5px; }
    textarea { width: 100%; height: 200px; margin-top: 10px; }
    .card { background: #fff; padding: 20px; border-radius: 10px; box-shadow: 0 0 10px #ddd; margin-bottom: 30px; }
    button { background: #3b82f6; color: white; border: none; border-radius: 5px; cursor: pointer; }
    button:hover { background: #2563eb; }
  </style>
</head>
<body>
<h1>ğŸ† Achievement API Tester</h1>

<div class="card">
  <h2>1ï¸âƒ£ ì „ì²´ ì—…ì  ì¡°íšŒ</h2>
  <button onclick="fetchAll()">ì¡°íšŒ</button>
</div>

<div class="card">
  <h2>2ï¸âƒ£ ì—…ì  ë“±ë¡</h2>
  <input id="name" placeholder="ì—…ì ëª…" />
  <input id="desc" placeholder="ì„¤ëª…" />
  <input id="type" placeholder="íƒ€ì… (ì˜ˆ: step)" />
  <input id="value" placeholder="ì¡°ê±´ê°’ (ì˜ˆ: 10000)" type="number" />
  <button onclick="createAchievement()">ë“±ë¡</button>
</div>

<div class="card">
  <h2>3ï¸âƒ£ ì¡°ê±´ ê¸°ë°˜ ì—…ì  ë‹¬ì„± ì²˜ë¦¬</h2>
  <input id="username" placeholder="username (ê³„ì •ëª…)" />
  <input id="steps" placeholder="currentSteps (ì˜ˆ: 12000)" type="number" />
  <button onclick="unlock()">ë‹¬ì„± ì²˜ë¦¬</button>
</div>

<div class="card">
  <h2>4ï¸âƒ£ ì‚¬ìš©ì ì—…ì  ë‚´ì—­ ì¡°íšŒ</h2>
  <input id="username2" placeholder="username (ê³„ì •ëª…)" />
  <button onclick="getUserAchievements()">ì¡°íšŒ</button>
</div>

<h2>ğŸ“¦ ê²°ê³¼</h2>
<textarea id="output" readonly></textarea>

<script>
  const base = "http://localhost:8081/api/achievements";
  const out = document.getElementById('output');

  async function fetchAll() {
    try {
      const res = await fetch(base);
      if (!res.ok) throw new Error("ì¡°íšŒ ì‹¤íŒ¨: " + res.status);
      out.value = JSON.stringify(await res.json(), null, 2);
    } catch (err) {
      out.value = err;
    }
  }

  async function createAchievement() {
    try {
      const data = {
        name: document.getElementById('name').value,
        description: document.getElementById('desc').value,
        conditionType: document.getElementById('type').value,
        conditionValue: parseInt(document.getElementById('value').value),
        iconUrl: "/images/achievements/test.png"
      };
      const res = await fetch(base, {
        method: "POST",
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify(data)
      });
      if (!res.ok) throw new Error("ë“±ë¡ ì‹¤íŒ¨: " + res.status);
      out.value = JSON.stringify(await res.json(), null, 2);
    } catch (err) {
      out.value = err;
    }
  }

  async function unlock() {
    try {
      const res = await fetch(base + "/unlock", {
        method: "POST",
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify({
          username: document.getElementById('username').value,
          currentSteps: parseInt(document.getElementById('steps').value)
        })
      });
      if (!res.ok) throw new Error("ë‹¬ì„± ì²˜ë¦¬ ì‹¤íŒ¨: " + res.status);
      out.value = JSON.stringify(await res.json(), null, 2);
    } catch (err) {
      out.value = err;
    }
  }

  async function getUserAchievements() {
    try {
      const username = document.getElementById('username2').value;
      const res = await fetch(base + "/user/" + username);
      if (!res.ok) throw new Error("ì¡°íšŒ ì‹¤íŒ¨: " + res.status);
      out.value = JSON.stringify(await res.json(), null, 2);
    } catch (err) {
      out.value = err;
    }
  }
</script>
</body>
</html>
